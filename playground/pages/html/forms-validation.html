<!doctype html>
<html lang="en">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Forms - Validation</title>
  <link rel="stylesheet" href="../styles/base.css">
  <link rel="stylesheet" href="../styles/components.css">
  </head>
<body>
  <a href="./../../index.html" data-testid="back">‚Üê back</a>
  <h1 data-testid="page-title">Forms - Validation</h1>
  <div data-testid="page-id" data-page-id="forms-validation"></div>

  <form data-testid="form-validation" id="fv" novalidate>
    <label for="req">Required</label><input data-testid="v-required" id="req" name="req" required placeholder="required" />
    <label for="pat">Pattern (ABC-123)</label><input data-testid="v-pattern" id="pat" name="pat" pattern="^[A-Z]{3}-\d{3}$" placeholder="ABC-123" />
    <label for="minmax">Min/Max (1..5)</label><input data-testid="v-minmax" id="minmax" name="minmax" type="number" min="1" max="5" />
    <label for="len">Minlength 5</label><input data-testid="v-minlength" id="len" name="len" minlength="5" />
    <label for="mail">Email</label><input data-testid="v-email" id="mail" name="mail" type="email" placeholder="a@b.com" />

    <div style="grid-column:1/-1;display:flex;gap:10px;flex-wrap:wrap">
      <button data-testid="btn-native" type="submit">Validate (custom)</button>
      <button data-testid="btn-report" type="button">reportValidity()</button>
      <button data-testid="btn-setcustom" type="button">setCustomValidity on pattern</button>
      <button data-testid="btn-clearcustom" type="button">clear custom validity</button>
    </div>

    <div class="msg" data-testid="validation-summary"></div>
    <small style="grid-column:1/-1">This page uses <code>novalidate</code> and shows errors via JS, but can also trigger native UI with <code>reportValidity()</code>.</small>
  </form>

  <script>
    const fv=document.getElementById("fv"), sum=document.querySelector("[data-testid='validation-summary']"), pat=document.getElementById("pat");
    const show=()=>{const errs=[...fv.elements].filter(el=>el instanceof HTMLInputElement&&el.willValidate&&!el.checkValidity()).map(el=>`${el.name}: ${el.validationMessage}`);sum.textContent=errs.length?errs.join("\n"):"No validation errors";};
    fv.addEventListener("submit", e=>{e.preventDefault();show();});
    document.querySelector("[data-testid='btn-report']").addEventListener("click", ()=>fv.reportValidity());
    document.querySelector("[data-testid='btn-setcustom']").addEventListener("click", ()=>{if(pat.value&&!/^[A-Z]{3}-\d{3}$/.test(pat.value))pat.setCustomValidity("Custom: must match ABC-123 exactly");else pat.setCustomValidity("");show();});
    document.querySelector("[data-testid='btn-clearcustom']").addEventListener("click", ()=>{pat.setCustomValidity("");show();});
    fv.addEventListener("input", show); show();
  </script>
</body>
</html>
